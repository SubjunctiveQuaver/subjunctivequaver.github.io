<!DOCTYPE html><html lang="en-AU" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="A generatingfunctionological proof of the geometric and arithmetic sequence formulas" /><meta property="og:locale" content="en_AU" /><meta name="description" content="Recall from high school that a geometric sequence is a sequence \((a_n)_{n \geq 0}\) that satisfies the recurrence relation \(a_{n + 1} = r a_n\) for some fixed \(r \in \mathbb{R}\), and an arithmetic sequence is a sequence \((b_n)_{n \geq 0}\) that satisfies \(b_{n + 1} = b_n + d\) for some fixed \(d \in \mathbb{R}\)." /><meta property="og:description" content="Recall from high school that a geometric sequence is a sequence \((a_n)_{n \geq 0}\) that satisfies the recurrence relation \(a_{n + 1} = r a_n\) for some fixed \(r \in \mathbb{R}\), and an arithmetic sequence is a sequence \((b_n)_{n \geq 0}\) that satisfies \(b_{n + 1} = b_n + d\) for some fixed \(d \in \mathbb{R}\)." /><link rel="canonical" href="https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/" /><meta property="og:url" content="https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/" /><meta property="og:site_name" content="Epic Maths Time" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-16T11:28:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="A generatingfunctionological proof of the geometric and arithmetic sequence formulas" /><meta name="twitter:site" content="@SubjunctiveQuav" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-17T23:14:33+10:00","datePublished":"2022-04-16T11:28:00+10:00","description":"Recall from high school that a geometric sequence is a sequence \\((a_n)_{n \\geq 0}\\) that satisfies the recurrence relation \\(a_{n + 1} = r a_n\\) for some fixed \\(r \\in \\mathbb{R}\\), and an arithmetic sequence is a sequence \\((b_n)_{n \\geq 0}\\) that satisfies \\(b_{n + 1} = b_n + d\\) for some fixed \\(d \\in \\mathbb{R}\\).","headline":"A generatingfunctionological proof of the geometric and arithmetic sequence formulas","mainEntityOfPage":{"@type":"WebPage","@id":"https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/"},"url":"https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/"}</script><title>A generatingfunctionological proof of the geometric and arithmetic sequence formulas | Epic Maths Time</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Epic Maths Time"><meta name="application-name" content="Epic Maths Time"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/SubjunctiveQuaver/subjunctivequaver.github.io/main/SubjunctiveQuaver.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Epic Maths Time</a></div><div class="site-subtitle font-italic">Lawrence's blog on epic mathematical tidbits!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/SubjunctiveQuaver" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/SubjunctiveQuav" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['lawrence.d.chen','outlook.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/lawrencechen11/" aria-label="linkedin" class="order-7" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="" aria-label="" class="order-8" target="_blank" rel="noopener"> <i class=""></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>A generatingfunctionological proof of the geometric and arithmetic sequence formulas</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>A generatingfunctionological proof of the geometric and arithmetic sequence formulas</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Lawrence Chen </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Apr 16, 2022, 11:28 AM +1000" >Apr 16, 2022<i class="unloaded">2022-04-16T11:28:00+10:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 17, 2022, 11:14 PM +1000" >Apr 17, 2022<i class="unloaded">2022-04-17T23:14:33+10:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2797 words">15 min read</span></div></div><div class="post-content"><p>Recall from high school that a <strong>geometric sequence</strong> is a sequence \((a_n)_{n \geq 0}\) that satisfies the <em>recurrence relation</em> \(a_{n + 1} = r a_n\) for some fixed \(r \in \mathbb{R}\), and an <strong>arithmetic sequence</strong> is a sequence \((b_n)_{n \geq 0}\) that satisfies \(b_{n + 1} = b_n + d\) for some fixed \(d \in \mathbb{R}\).</p><p>For example, the sequences \((1,2,4,8,16,\dotsc)\) and \((1,-1,1,-1,1,\dotsc)\) are geometric, while the sequences \((0,1,2,3,4,\dotsc)\) and \((11,7,3,-1,-5,\dotsc)\) are arithmetic.</p><p>You may recall, again from high school, the formulas</p>\[a_n = a_0 r^n \quad \text{and} \quad b_n = b_0 + nd\]<p>for a generic term of the above geometric and arithmetic sequences, respectively.</p><p><strong>Exercise 1.</strong> Verify that the above two formulas for geometric and arithmetic sequences hold, using a proof by induction or similar approach.</p><p>In this post, I will introduce a totally overkill approach of deriving these two formulas; this approach will turn out to be a general approach to solving many recurrence relations. The key to this approach is to use <em>generating functions</em>.</p><h2 id="a-naive-approach-for-geometric-sequences">A “naive” approach for geometric sequences</h2><p>Starting with \(a_{n + 1} = ra_n\), multiply by \(x^n\) and sum over all \(n \geq 0\) (for which this recurrence is valid for) to get</p>\[\sum_{n \geq 0} a_{n + 1}x^n = \sum_{n \geq 0} ra_n x^n = r \sum_{n \geq 0} a_n x^n.\]<p>If we let \(A(x) = \sum_{n \geq 0} a_n x^n\), then surely</p>\[\sum_{n \geq 0} a_{n + 1}x^n = \sum_{n \geq 1} a_nx^{n - 1} = \frac{1}{x} \sum_{n \geq 1} a_nx^n = \frac{1}{x} \left(\sum_{n \geq 0} a_nx^n - a_0\right) = \frac{1}{x}(A(x) - a_0),\]<p>so we get the equation</p>\[\frac{1}{x}(A(x) - a_0) = rA(x) \implies A(x) = \frac{a_0}{1 - rx} = a_0 \sum_{n \geq 0} (rx)^n = \sum_{n \geq 0} a_0 r^n x^n.\]<p>But recall that \(A(x) = \sum_{n \geq 0} a_n x^n\), so we must surely have \(a_n = a_0 r^n\), which agrees with the known formula!</p><p>So we solved the recurrence relation by using some sort of magical overkill power series approach. How exactly does it work, can we be more methodical, and is it even useful? I will attempt to answer that in the rest of this post.</p><h2 id="generating-functions">Generating functions</h2><p>Unless otherwise stated, all sequences \((a_n)_{n \geq 0} = (a_0,a_1,\dotsc)\) start with a zeroth term \(a_0\); I simply write \((a_n)\).</p><p><strong>Definition 1.</strong> Consider a sequence \((a_n)\). The <strong>(ordinary) generating function</strong> of \((a_n)\) is the <em>(formal) power series</em></p>\[A = \sum_{n \geq 0}a_n x^n = a_0 + a_1x + a_2x^2 + \dotsb\]<p>where the coefficient of \(x^n\), denoted \([x^n]A\), is precisely \(a_n\). We write \((a_n) \overset{\text{ops}}{\leftrightarrow} A\).</p><p>These power series are <em>formal</em> in the sense that we do not care about convergence: they are not analytic. In general, the \(x\) is to be interpreted as an indeterminate; a symbol that can be manipulated, but does not have meaning on its own. Representing a sequence in this way serves as to ensure that the terms in the sequence remain “separated” – they are separated by powers of \(x\).</p><h3 id="the-ring-of-formal-power-series">The ring of formal power series</h3><p>Every formal power series is associated with a unique sequence – its sequence of coefficients – and vice versa. Two formal power series are equal if and only if the sequences of coefficients are equal.</p><p>The set of formal power series forms a <strong>ring</strong> \(\mathbb{R}[[x]]\) in a natural way (where the coefficients are in \(\mathbb{R}\)); the addition is given by</p>\[\left(\sum_{n \geq 0}a_n x^n\right) + \left(\sum_{n \geq 0}b_n x^n\right) = \sum_{n \geq 0} (a_n + b_n)x^n,\]<p>and the (commutative) multiplication is given by</p>\[\left(\sum_{n \geq 0}a_n x^n\right)\left(\sum_{n \geq 0}b_n x^n\right) = \sum_{n \geq 0} \left(\sum_{k = 0}^n a_k b_{n - k}\right)x^n;\]<p>this looks funny but it’s what we would expect when we try to multiply out an (infinite) expression of the form</p>\[(a_0 + a_1x + a_2x^2 + \dotsb)(b_0 + b_1x + b_2x^2 + \dotsb) = a_0b_0 + (a_0b_1 + a_1b_0)x + (a_0b_2 + a_1b_1 + a_2b_0)x^2 + \dotsb\]<p>which it precisely is. The additive identity (zero) in \(\mathbb{R}[[x]]\) is the power series \(0 = 0 + 0x + 0x^2 + \dotsb \overset{\text{ops}}{\leftrightarrow} (0)\). The multiplicative identity (unit) in \(\mathbb{R}[[x]]\) is the power series \(1 = 1 + 0x + 0x^2 + \dotsb \overset{\text{ops}}{\leftrightarrow} (1,0,0,\dotsc)\).</p><p>For example, the (multiplicative) inverse of the power series \(1 - x = 1 - x + 0x^2 + 0x^3 + \dotsb\) turns out to be \(\sum_{n \geq 0}x^n = 1 + x + x^2 + \dotsb\); we can verify this by computing</p>\[(1 - x)(1 + x + x^2 + \dotsb) = 1 + (1 - 1)x + (1 - 1 + 0)x^2 + \dotsb = 1.\]<p>So it is reasonable to write that</p>\[\frac{1}{1 - x} = \sum_{n \geq 0} x^n = 1 + x + x^2 + \dotsb;\]<p>this is true in the formal sense, not just for \(\lvert x\rvert &lt; 1\) as in the analytical case. However, when the power series in the analytical sense converges, it is reasonable to substitute in numerical values for \(x\). This also gives us our first (simple) result:</p><p><strong>Lemma 1.</strong> Let \((1) = (1,1,\dotsc)\) be the constant sequence; then</p>\[\frac{1}{1 - x} \overset{\text{ops}}{\leftrightarrow} (1).\]<p>Note that extracting coefficients from power series is somehow “linear”, in the sense that \([x^n](A + kB) = [x^n]A + k[x^n]B\) (the formal power series also form a <em>vector space</em> over \(\mathbb{R}\), and this is a linear map (functional) \(\mathbb{R}[[x]] \to \mathbb{R}\)). This is a useful fact that we use later.</p><p><img data-proofer-ignore data-src="https://i.imgflip.com/31po1l.png" alt="Extracting coefficients from formal power series is linear: a useful tool that will help us later." /></p><h2 id="solving-recurrences--a-generatingfunctionological-approach">Solving recurrences – a generatingfunctionological approach</h2><p>Throughout this section, let \((a_n) \overset{\text{ops}}{\leftrightarrow} A\). A <strong>generatingfunctionological</strong> approach, as coined in <a href="https://www2.math.upenn.edu/~wilf/DownldGF.html">Wilf’s book “generatingfunctionology”</a>, is an approach to working with sequences using their generating functions.</p><p><strong>Definition 2.</strong> Let \((a_n)\) be a sequence. Then a (\(k\)th order) <strong>recurrence</strong> for \((a_n)\) is an equation \(\varphi(n,a_n,a_{n + 1},\dotsc,a_{n + k}) = 0\) which holds for particular \(n\).</p><p>If we fix a value of \(n\), then a recurrence gives us one equation that \((a_n)\) satisfies. However, the expression</p>\[\sum_n \varphi(n,a_n,a_{n + 1},\dotsc,a_{n + k})x^n = 0\]<p>simultaneously encodes <em>every</em> equation that \((a_n)\) satisfies that is given by the recurrence. In the (usual) case that \(n\) ranges over \(\mathbb{N}\), we recover the generating function of \((a_n)\); otherwise observe for instance that \(\sum_{n \geq N} a_n x^n = A - a_0 - a_1x - \dotsb - a_{N - 1}x^{N - 1}\).</p><p>Thus, to solve a recurrence relation, we can attempt to convert the recurrence for \((a_n)\) into an equation involving its generating function \(A\) by finding the generating functions of the sequences equated in the recurrence; then if we can solve this for \(A\), then we have found \(a_n = [x^n]A\). However, we may not explicitly find \(A\) as a (formal) power series; using different techniques (such as partial fractions or the binomial theorem) we can find a power series expansion to extract the coefficients \(a_n\).</p><p>A recurrence is <strong>linear</strong> if \(a_{n + k} = f_0 a_n + f_1 a_{n + 1} + \dotsb + f_{k - 1} a_{n + k - 1}\) for some \(k\), where each \(f_i\), a <strong>coefficient</strong>, is a function of \(n\). We present a quick theorem without proof:</p><p><strong>Theorem 1.</strong> Let \(A \overset{\text{ops}}{\leftrightarrow} (a_n)\). Then \(A\) is a rational function \(p/q\) (where \(p,q\) have lowest possible degree) with \(\deg q = k\) if and only if \((a_n)\) satisfies a linear recurrence with constant coefficients of order \(k\).</p><p>After reading this article, you will have the tools to prove this theorem yourself! (If you want to, of course!) One direction is by the technique for finding a generating function outlined below, and the other direction follows by considering an expansion of \(q A = p\).</p><h3 id="the-algebra-and-calculus-of-generating-functions">The algebra and calculus of generating functions</h3><p><strong>Definition 3.</strong> The <strong>(formal) derivative</strong> of a power series \(A = \sum_{n \geq 0} a_nx^n \overset{\text{ops}}{\leftrightarrow} (a_n)\) is the power series</p>\[DA = \sum_{n \geq 1} n a_n x^{n - 1} = \sum_{n \geq 0} (n + 1)a_{n + 1}x^n \overset{\text{ops}}{\leftrightarrow} ((n + 1)a_{n + 1}).\]<p>The <strong>derivative operator</strong> \(D\) on \(\mathbb{R}[[x]]\) is the map \(A \mapsto DA\).</p><p>We can verify some expected properties of the derivative operator: it is a <strong>derivation</strong> on \(\mathbb{R}[[x]]\) (let \(A,B \in \mathbb{R}[[x]]\)), since</p><ul><li>It is <em>linear</em> (where we think of \(\mathbb{R}[[x]]\) as a vector space): \(D(A + kB) = DA + kDB\) where \(k \in \mathbb{R}\),<li>It satisfies a sort of <em>(Leibniz) product rule</em>: \(D(AB) = A(DB) + (DA)B\).</ul><p><strong>Exercise 2.</strong> Check thse both! Remember to use the correct rule for multiplying power series for the product rule.</p><p>We can also combine the derivative operator with other operators on \(\mathbb{R}[[x]]\). For operators \(S,T\), define their <strong>sum</strong> \(S + T\) to be the map \(A \mapsto SA + TA\) (<em>pointwise addtion</em>), and their <strong>product</strong> \(ST\) to be the map \(A \mapsto S(TA)\) (<em>composition of operators</em>). The \(k\)th <strong>iterate</strong> of \(T\) is defined by \(T^k := \underbrace{TT\dotsb T}_{k\ \text{copies}}\), which is the map \(A \mapsto \underbrace{T(T(\dotsb(TA)\dotsb))}_{k\ \text{times}}\).</p><p><em>Repeated differentiation</em> is denoted by \(D^k\), i.e. \(D^kA\) is the \(k\)th (formal) derivative of \(A\). Another common operator that comes up when solving recurrences is the <strong><del>ecks dee</del> xD operator</strong> \(xD\) on \(\mathbb{R}[[x]]\), defined as the map \(A \mapsto xDA\), i.e. differentiation then multiplication by \(x\). We often deal with <em>polynomials</em> in \(xD\), where \(1\) denotes the <strong>identity operator</strong> \(A \mapsto A\), but note that \((xD)^2 = xD(xD) \neq x^2 D^2\). Indeed,</p>\[(xD)^2 = xD(xD) = x(D + xD^2) = xD + x^2D^2 \implies (xD)^2A = xDA + x^2D^2A\]<p>by the product rule. Furthermore, care must be taken as these operators do not generally commute: while \(xD(xD + 1) = (xD)^2 + xD = (xD + 1)xD\), note that \(Dx \neq xD\) (we can think of $x$ as an operator on \(\mathbb{R}[[x]]\) with \(A \mapsto xA\); then \(Dx1 = Dx = 1 \neq 0 = xD1\)). This is all related to the notion of a <a href="https://en.wikipedia.org/wiki/Weyl_algebra">Weyl algebra</a>, which is a ring of <em>differential operators</em> with polynomial coefficients (the addition is pointwise addition, and the product is composition of operators).</p><p><strong>Exercise 3.</strong> Similar to the above, what is an expansion of \((xD)^k\) without any powers of \(xD\)? <del>(I haven’t tried this yet, but it looks promising.)</del> Update (thanks <a href="https://piecewise.org/exploration/an-adventure-in-rewriting-polynomials">Ally</a> and Jacob): it looks like</p>\[(xD)^k = \left\{k \atop 0\right\} + \left\{k \atop 1\right\} xD + \left\{k \atop 2\right\} x^2D^2 + \dotsb + \left\{k \atop k\right\} x^k D^k,\]<p>where</p>\[\left\{k \atop n\right\} = \frac{1}{n!} \sum_{i = 0}^n (-1)^i \binom{n}{i} (n - i)^k\]<p>are <a href="https://en.wikipedia.org/wiki/Stirling_numbers_of_the_second_kind">Stirling numbers of the 2nd kind</a>, which count the number of ways to partition \([n] = \{1,\dotsc,n\}\) into \(k\) (nonempty) parts. (Note that \(\left\{k \atop 0\right\} = 0\) if \(k \geq 1\), but \(\left\{0 \atop 0\right\} = 1\), and \((xD)^0 = 1 = \operatorname{Id}_{\mathbb{R}[[x]]}\), so the pattern holds.) Prove/disprove this claim, and post your solutions in the unofficial <a href="https://discord.gg/hx63ZwSXBg">Maths @ Monash Discord</a>!</p><p>Using these, we can identify some rules for the generating functions of some transformations of sequences:</p><p><strong>Lemma 2.</strong> Let \((a_n) \overset{\text{ops}}{\leftrightarrow} A\) and \((b_n) \overset{\text{ops}}{\leftrightarrow} B\). Then</p><ol><li>For any fixed \(m &gt; 0\), \((a_{n + m}) \overset{\text{ops}}{\leftrightarrow} \frac{1}{x^m}(A - a_0 - a_1x - \dotsb - a_{m - 1}x^{m - 1})\)<li>If \(p(n)\) is any polynomial in \(n\), then \(p(xD)A \overset{\text{ops}}{\leftrightarrow} (p(n)a_n)\)<li> \[AB \overset{\text{ops}}{\leftrightarrow} \left(\sum_{k = 0}^n a_k b_{n - k}\right)_n\]<li>For any \(k \in \mathbb{R}\), \(A + kB \overset{\text{ops}}{\leftrightarrow} (a_n + kb_n)\)<li> \[\frac{A}{1 - x} \overset{\text{ops}}{\leftrightarrow} \left(\sum_{k = 0}^n a_k\right)_n\]<li>For a fixed \(k &gt; 0\), if \(b_{kn} = a_n\) for \(n \geq 0\) and \(b_m = 0\) otherwise, then \(A(x^k) = B(x) \overset{\text{ops}}{\leftrightarrow} (b_n)\)</ol><p>Note that in rule 1, we don’t mean division by \(x^m\) in the ring \(\mathbb{R}[[x]]\), as it does not have an inverse. Rather, it is the <a href="https://math.stackexchange.com/questions/3744068/what-is-the-meaning-of-division-of-a-formal-power-series-by-x">quotient in an Euclidean division</a> (note that \(\mathbb{R}[[x]]\) is a <em>Euclidean domain</em>).</p><p>We give a proof of rule 2; it suffices to prove it for monic monomials; then apply rule 4. Let \(p(n) = n^k\); then \(p(xD)A = (xD)^kA\). The case \(k = 0\) is trivial. Then if \(k &gt; 0\), we proceed by induction on \(k\) and note that</p>\[p(xD)A = (xD)^kA = xD(xD)^{k - 1}A = xD \sum_{n \geq 0} n^{k - 1}a_n x^n = x \sum_{n \geq 1} n^ka_n x^{n - 1} = \sum_{n \geq 0} n^ka_n x^n \overset{\text{ops}}{\leftrightarrow} (n^ka_n) = (p(n)a_n);\]<p>the 3rd equality is by the inductive hypothesis (i.e. that \((xD)^{k - 1}A = \sum_{n \geq 0} n^{k - 1}a_n x^n \overset{\text{ops}}{\leftrightarrow} (n^{k - 1}a_n)\)). Thus we are done!</p><p><strong>Exercise 4.</strong> Prove the unproven generating function rules 1,3,4,5,6 above. (Hint for rule 5: use rule 3 and Lemma 1.) Post your solutions in the unofficial <a href="https://discord.gg/hx63ZwSXBg">Maths @ Monash Discord</a>!</p><h3 id="finding-formulas-for-the-geometric-and-arithmetic-sequences">Finding formulas for the geometric and arithmetic sequences</h3><p>Using the algebra and calculus of generating functions, we give a succinct generatingfunctionological proof of the formulas for the geometric and arithmetic sequences.</p><p>Recall that the <strong>geometric sequence</strong> \((a_n)_{n \geq 0}\) satisfies \(a_{n + 1} = r a_n\). Let \((a_n) \overset{\text{ops}}{\leftrightarrow} A\). Then by rule 1, \((a_{n + 1}) \overset{\text{ops}}{\leftrightarrow} \frac{1}{x}(A - a_0)\), so the recurrence (and rule 4) yields</p>\[\frac{1}{x}(A - a_0) = rA \implies A = \frac{a_0}{1 - rx}.\]<p>Extracting coefficients and using (the surprise tool) linearity, we recover</p>\[a_n = [x^n]A = a_0[x^n]\sum_{n \geq 0}(rx)^n = a_0r^n.\]<p>Now, the <strong>arithmetic sequence</strong> \((b_n)_{n \geq 0}\) satisfies \(b_{n + 1} = b_n + d\). Let \((b_n) \overset{\text{ops}}{\leftrightarrow} B\). Then by rule 1, \((b_{n + 1}) \overset{\text{ops}}{\leftrightarrow} \frac{1}{x}(B - b_0)\); Lemma 1 and rule 4 yields \((d) \overset{\text{ops}}{\leftrightarrow} \frac{d}{1 - x}\), so the recurrence (and rule 4) yields (by partial fractions)</p>\[\frac{1}{x}(B - b_0) = B + \frac{d}{1 - x} \implies B = \frac{b_0 - d}{1 - x} + \frac{d}{(1 - x)^2}.\]<p>By rule 2 with \(p(n) = n\), we have</p>\[xD\frac{1}{1 - x} \overset{\text{ops}}{\leftrightarrow} (p(n)1) = (n) \implies \frac{1}{(1 - x)^2} = \frac{1}{x} \left(xD\frac{1}{1 - x} - 0\right) \overset{\text{ops}}{\leftrightarrow} (n + 1)\]<p>by rule 1. (There are other ways to do this, such as direct manipulation of the power series, but that’s boring!) Thus by linearity, we extract the coefficient</p>\[b_n = [x^n]B = (b_0 - d)[x^n]\frac{1}{1 - x} + d[x^n]\frac{1}{(1 - x)^2} = (b_0 - d)1 + d(n + 1) = b_0 + dn\]<p>since \((1) \overset{\text{ops}}{\leftrightarrow} \frac{1}{1 - x}\) and \((n + 1) \overset{\text{ops}}{\leftrightarrow} \frac{1}{(1 - x)^2}\) (recall what this means). This is the formula for the arithmetic sequence; how awesome! (OK that was totally overkill LOL.)</p><p><strong>Exercise 5.</strong> Show that</p>\[\frac{1}{(1 - x)^2} \overset{\text{ops}}{\leftrightarrow} (n + 1)\]<p>in the following alternative ways:</p><ol><li>Use the fact that \(\frac{1}{(1 - x)^2} = D\frac{1}{1 - x}\), and explicitly differentiating the power series \(\sum_{n \geq 0} x^n\) and identifying the coefficient that appears.<li>Use the fact that \(\frac{1}{(1 - x)^2} = D\frac{1}{1 - x}\) again, but look at the comment in Definition 3 (i.e. that \(DA \overset{\text{ops}}{\leftrightarrow} ((n + 1)a_{n + 1}).\) if \(A \overset{\text{ops}}{\leftrightarrow} (a_n)\); choose \((a_n)\) carefully).<li>Use fact 5 repeatedly, starting from $A = 1$. (What sequence is this the generating function of?)</ol><p>Post your solutions in the unofficial <a href="https://discord.gg/hx63ZwSXBg">Maths @ Monash Discord</a>!</p><h3 id="a-few-more-applications-an-outline-only">A few more applications (an outline only)</h3><p>There are many nice applications of this generatingfunctionological technique. Here are just a few:</p><ul><li>The <strong>Fibonacci sequence</strong> \((F_n)\) satisfies the linear recurrence \(F_{n + 2} = F_{n + 1} + F_n\) for \(n \geq 0\) with \(F_0 = 0\) and \(F_1 = 1\). It has generating function \(F = \frac{x}{1 - x - x^2}\); we can recover a formula for \(F_n\) using partial fractions.<li>The <strong>binomial theorem</strong> \((1 + x)^\alpha = \sum_{n \geq 0} \binom{\alpha}{n} x^n \overset{\text{ops}}{\leftrightarrow} \left(\binom{\alpha}{n}\right)_n\) where \(\alpha \in \mathbb{R}\). I talk about this in more detail in <a href="https://subjunctivequaver.github.io/posts/generatingfunctionological-proof-binomial-theorem/">the next post</a>!<li>The <strong>Catalan numbers</strong> \(C_n = \frac{1}{n + 1} \binom{2n}{n}\) have generating function \(C = \frac{1 - \sqrt{1 - 4x}}{2x}\); using the binomial theorem with \(\alpha = 1/2\), we can recover this formula for \(C_n\). Moreover, they satisfy the recurrence \(C_{n + 1} = \sum_{i = 0}^n C_i C_{n - i}\) with \(C_0 = 1\); note that \(\left(\sum_{i = 0}^n C_i C_{n - i}\right) \overset{\text{ops}}{\leftrightarrow} C^2\) by rule 3, so \(\frac{1}{x}(C - 1) = \frac{1}{x}(C - C_0) = C^2 \iff C - 1 = xC^2\), which can be used to find \(C\) as before (use the initial condition \(C_0 = 1\) to pick the negative square root). Note that \(C_n\) is, for instance, the number of ways to have a balanced string of parentheses of length \(2n\), e.g. something like <code class="language-plaintext highlighter-rouge">(()(()))(())</code>, but not <code class="language-plaintext highlighter-rouge">())((())</code>.</ul><p><strong>Exercise 6.</strong> (Adapted from discussion on the <a href="https://discord.gg/hx63ZwSXBg">Maths @ Monash Discord</a> server.) Consider the <strong>triangular numbers</strong> \(T_n = \frac{n(n + 1)}{2}\), and define a recurrence \(a_{n + 1} = a_n + T_n\), with \(a_0 = 0\). Find a linear recurrence with constant coefficients that \((a_n)\) satisfies (consider Theorem 1 above), and use a generatingfunctionological approach to find an explicit formula for \(a_n\) (feel free to use a computer to find a series expansion). Post your solutions in the unofficial <a href="https://discord.gg/hx63ZwSXBg">Maths @ Monash Discord</a>!</p><p>Happy generatingfunctionologing (and happy Easter too $xD$)!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/epic-maths-time/'>Epic Maths Time</a>, <a href='/categories/new-perspectives/'>New Perspectives</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/combinatorics/" class="post-tag no-text-decoration" >combinatorics</a> <a href="/tags/algebra/" class="post-tag no-text-decoration" >algebra</a> <a href="/tags/uni-maths/" class="post-tag no-text-decoration" >uni-maths</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=A generatingfunctionological proof of the geometric and arithmetic sequence formulas - Epic Maths Time&url=https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=A generatingfunctionological proof of the geometric and arithmetic sequence formulas - Epic Maths Time&u=https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=A generatingfunctionological proof of the geometric and arithmetic sequence formulas - Epic Maths Time&url=https://subjunctivequaver.github.io//posts/generatingfunctionological-proof-geometric-arithmetic-sequences/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/honours-thesis/">My honours thesis — minimum bases for permutation groups</a><li><a href="/posts/generatingfunctionological-proof-geometric-arithmetic-sequences/">A generatingfunctionological proof of the geometric and arithmetic sequence formulas</a><li><a href="/posts/generatingfunctionological-proof-binomial-theorem/">A generatingfunctionological proof of the binomial theorem</a><li><a href="/posts/integrating-rational-functions/">Integrating rational functions, partial fractions, and a taste of algebra, part 1</a><li><a href="/posts/measure-theory-in-probability/">Why probability and statistics need measure theory, part 1</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/uni-maths/">uni-maths</a> <a class="post-tag" href="/tags/algebra/">algebra</a> <a class="post-tag" href="/tags/calculus/">calculus</a> <a class="post-tag" href="/tags/combinatorics/">combinatorics</a> <a class="post-tag" href="/tags/measure-theory/">measure-theory</a> <a class="post-tag" href="/tags/polynomials/">polynomials</a> <a class="post-tag" href="/tags/probability/">probability</a> <a class="post-tag" href="/tags/rings/">rings</a> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/topology/">topology</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/generatingfunctionological-proof-binomial-theorem/"><div class="card-body"> <span class="timeago small" >Apr 16, 2022<i class="unloaded">2022-04-16T13:00:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A generatingfunctionological proof of the binomial theorem</h3><div class="text-muted small"><p> Make sure you have read the last post on generating functions first, else proceed at your own risk! Recall that for \(k,n \in \mathbb{N}\), the binomial coefficient is defined by \[\binom{k}{n} =...</p></div></div></a></div><div class="card"> <a href="/posts/integrating-rational-functions/"><div class="card-body"> <span class="timeago small" >Jun 29, 2021<i class="unloaded">2021-06-29T15:42:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Integrating rational functions, partial fractions, and a taste of algebra, part 1</h3><div class="text-muted small"><p> You know how to integrate a polynomial: [\int (a_0 + a_1x + \dotsb + a_nx^n) \,dx = C + a_0x + \frac{a_1}{2}x^2 + \dotsb + \frac{a_n}{n + 1}x^{n + 1},] where \(C \in \mathbb R\) is a real constan...</p></div></div></a></div><div class="card"> <a href="/posts/integrating-rational-functions-2/"><div class="card-body"> <span class="timeago small" >Jun 29, 2021<i class="unloaded">2021-06-29T15:42:00+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Integrating rational functions, partial fractions, and a taste of algebra, part 2</h3><div class="text-muted small"><p> Make sure you read part 1 first! Recall that we were exploring integrating rational functions, and to do so, we needed to look at partial fraction decompositions. As we now begin to discuss that in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/integrating-rational-functions-2/" class="btn btn-outline-primary" prompt="Older"><p>Integrating rational functions, partial fractions, and a taste of algebra, part 2</p></a> <a href="/posts/generatingfunctionological-proof-binomial-theorem/" class="btn btn-outline-primary" prompt="Newer"><p>A generatingfunctionological proof of the binomial theorem</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/SubjunctiveQuav">Lawrence Chen</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/uni-maths/">uni maths</a> <a class="post-tag" href="/tags/algebra/">algebra</a> <a class="post-tag" href="/tags/calculus/">calculus</a> <a class="post-tag" href="/tags/combinatorics/">combinatorics</a> <a class="post-tag" href="/tags/measure-theory/">measure theory</a> <a class="post-tag" href="/tags/polynomials/">polynomials</a> <a class="post-tag" href="/tags/probability/">probability</a> <a class="post-tag" href="/tags/rings/">rings</a> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/topology/">topology</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
